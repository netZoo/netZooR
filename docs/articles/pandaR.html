<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to the pandaR Package • netZooR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to the pandaR Package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">netZooR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ALPACA.html">Detecting differential modules using ALPACA</a>
    </li>
    <li>
      <a href="../articles/ApplicationinGTExData.html">Building PANDA and LIONESS Regulatory Networks from GTEx Gene Expression Data in R</a>
    </li>
    <li>
      <a href="../articles/ApplicationwithTBdataset.html">Application with TB dataset</a>
    </li>
    <li>
      <a href="../articles/MONSTER.html">An Introduction to the MONSTER Package</a>
    </li>
    <li>
      <a href="../articles/SAMBAR.html">SAMBAR: Subtyping Agglomerated Mutations By Annotation Relations</a>
    </li>
    <li>
      <a href="../articles/pandaR.html">An Introduction to the pandaR Package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An Introduction to the pandaR Package</h1>
                        <h4 class="author">Daniel Schlauch, Albert Young, Joseph N. Paulson</h4>
            
            <h4 class="date">2019-12-11</h4>
      
      
      <div class="hidden name"><code>pandaR.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The fundamental concepts behind the PANDA approach is to model the regulatory network as a bipartite network and estimate edge weights based on the evidence that information from a particular transcription factor <em>i</em> is successfully being passed to a particular gene <em>j</em>. This evidence comes from the agreement between two measured quantities. First, the correlation in expression between gene <em>j</em> and other genes. And second, the strength of evidence of the existence of an edge between TF <em>i</em> and those same genes. This concordance is measured using Tanimoto similarity. A gene is said to be available if there is strong evidence of this type of agreement. Analogous to this is the concept of responsibility which similarly focuses on a TF-gene network edge but instead measures the concordance between suspected protein-complex partners of TF <em>i</em> and the respective strength of evidence of a regulatory pathway between those TFs and gene <em>j</em>.</p>
<p>PANDA utilizes an iterative approach to updating the bipartite edge weights incrementally as evidence for new edges emerges and evidence for existing edges diminishes. This process continues until the algorithm reaches a point of convergence settling on a final score for the strength of information supporting a regulatory mechanism for every pairwise combination of TFs and genes. This package provides a straightforward tool for applying this established method. Beginning with data.frames or matrices representing a set of gene expression samples, motif priors and optional protein-protein interaction users can generate an <em>m</em> by <em>n</em> matrix representing the bipartite network from <em>m</em> TFs regulating <em>n</em> genes. Additionally, pandaR reports the co-regulation and cooperative networks at convergence. These are reported as complete graphs representing the evidence for gene co-regulation and transcription factor cooperation.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>An example dataset derived from a subset of stress-induced Yeast is available by running</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(pandaR)</code></pre></div>
<pre><code>## Loading required package: Biobase</code></pre>
<pre><code>## Loading required package: BiocGenerics</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: 'BiocGenerics'</code></pre>
<pre><code>## The following objects are masked from 'package:parallel':
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     IQR, mad, sd, var, xtabs</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     anyDuplicated, append, as.data.frame, basename, cbind,
##     colMeans, colnames, colSums, dirname, do.call, duplicated,
##     eval, evalq, Filter, Find, get, grep, grepl, intersect,
##     is.unsorted, lapply, lengths, Map, mapply, match, mget, order,
##     paste, pmax, pmax.int, pmin, pmin.int, Position, rank, rbind,
##     Reduce, rowMeans, rownames, rowSums, sapply, setdiff, sort,
##     table, tapply, union, unique, unsplit, which, which.max,
##     which.min</code></pre>
<pre><code>## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with
##     'browseVignettes()'. To cite Bioconductor, see
##     'citation("Biobase")', and for packages 'citation("pkgname")'.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(pandaToyData)</code></pre></div>
<p><strong>pandaToyData</strong> is a list containing a regulatory structure derived from sequence motif analysis, protein-protein interaction data and a gene expression. The primary function in pandaR is called with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pandaResult &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/pandaR/man/panda.html">panda</a></span>(pandaToyData<span class="op">$</span>motif, pandaToyData<span class="op">$</span>expression, pandaToyData<span class="op">$</span>ppi)
pandaResult</code></pre></div>
<pre><code>## PANDA network for1000genes and87transcription factors.</code></pre>
<pre><code>## 
## Slots:</code></pre>
<pre><code>## regNet   : Regulatory network of 87 transcription factors to 1000 genes.</code></pre>
<pre><code>## coregNet: Co-regulation network of 1000 genes.</code></pre>
<pre><code>## coopNet  : Cooperative network of 87 transcription factors.</code></pre>
<pre><code>## Regulatory graph contains 87000 edges.</code></pre>
<pre><code>## Regulatory graph is complete.</code></pre>
<p>Where <strong>pandaResult</strong> is a ‘panda’ object which contains <strong>data.frame</strong>s describing the complete bipartite gene regulatory network as well as complete networks for gene coregulation and transcription factor cooperation. Due to completeness, edgeweights for the regulatory network are reported for all <em>m</em>x<em>n</em> possible TF-gene edges. The distribution of these edge weights for these networks has approximate mean 0 and standard deviation 1. The edges are therefore best interpreted in a relative sense. Strongly positive values indicative of relatively larger amounts of evidence in favor a regulatory mechanism and conversely, smaller or negative values can be interpreted as lacking evidence of a shared biological role. It is naturally of interest to specify a high edge weight subset of the complete network to investigate as a set of present/absent edges. This is easily performed by using the <strong>topedges</strong> function. A network containing the top 1000 edge scores as binary edges can be obtained by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">topNet &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/pandaR/man/topedges.html">topedges</a></span>(pandaResult, <span class="dv">1000</span>)</code></pre></div>
<p>Users may then examine the genes targeted by a transcription factor of interest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/pkg/pandaR/man/targetedGenes.html">targetedGenes</a></span>(topNet, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AR"</span>))</code></pre></div>
<pre><code>##  [1] "AKAP10"       "CNDP2"        "CRHR1"        "HNRNPD"      
##  [5] "KIAA0652"     "LOC100093631" "LOC100128811" "PRR15"       
##  [9] "TCF4"         "TCP11L2"      "TMPRSS11B"    "VCX3B"       
## [13] "WDR4"</code></pre>
<p>The network can be further simplified by focusing only on transcription factors on interest and the genes that they are found to regulate. The <strong>subnetwork</strong> method serves this function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">topSubnet &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/pandaR/man/subnetwork.html">subnetwork</a></span>(topNet, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AR"</span>,<span class="st">"ARID3A"</span>,<span class="st">"ELK1"</span>))</code></pre></div>
<p>Existing R packages, such as igraph, can be used to visualize the results</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/pkg/pandaR/man/plotGraph.html">plotGraph</a></span>(topSubnet)</code></pre></div>
<p><img src="pandaR_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="comparing-state-specific-panda-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-state-specific-panda-networks" class="anchor"></a>Comparing state-specific PANDA networks</h2>
<p>We provide a number of useful plotting functions for the analysis of the networks. The main functions used to plot and analyze the PANDA networks are:</p>
<ul>
<li>
<em>plotZ</em> -Comparison of Z scores between two PANDA runs</li>
<li>
<em>plotZbyTF</em> - Plot Z by TF outdegree quartiles</li>
</ul>
<p>We can compare how parameter choices effect the Z-score estimation between two PANDA runs. Additionally, we can compare two phenotypes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">panda.res1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(pandaToyData, <span class="kw"><a href="https://rdrr.io/pkg/pandaR/man/panda.html">panda</a></span>(motif, expression, ppi, <span class="dt">hamming=</span><span class="dv">1</span>))
panda.res2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(pandaToyData, <span class="kw"><a href="https://rdrr.io/pkg/pandaR/man/panda.html">panda</a></span>(motif, expression <span class="op">+</span><span class="st"> </span>
<span class="st">                   </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/prod.html">prod</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(expression)),<span class="dt">sd=</span><span class="dv">5</span>), ppi, <span class="dt">hamming=</span><span class="dv">1</span>))
<span class="kw"><a href="https://rdrr.io/pkg/pandaR/man/plotZ.html">plotZ</a></span>(panda.res1, panda.res2,<span class="dt">addLine=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Warning: package 'hexbin' was built under R version 3.5.2</code></pre>
<p><img src="pandaR_files/figure-html/plotZ-1.png" width="700"></p>
<p>Other comparisons are underway…</p>
</div>
<div id="other-helpful-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#other-helpful-functions" class="anchor"></a>Other helpful functions</h2>
<p>There are a host of other helpful functions, including <em>testMotif</em>, <em>plotCommunityDetection</em>, and <em>multiplot</em>. See the full help pages.</p>
</div>
<div id="session-information" class="section level2">
<h2 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</code></pre></div>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS  10.14.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
## [1] hexbin_1.27.3       pandaR_1.14.0       Biobase_2.42.0     
## [4] BiocGenerics_0.28.0
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.1         compiler_3.5.1     pillar_1.3.1      
##  [4] plyr_1.8.4         tools_3.5.1        digest_0.6.18     
##  [7] evaluate_0.13      memoise_1.1.0      tibble_2.1.1      
## [10] gtable_0.2.0       lattice_0.20-38    pkgconfig_2.0.2   
## [13] rlang_0.4.0        igraph_1.2.4       rstudioapi_0.8    
## [16] yaml_2.2.0         pkgdown_1.4.1.9000 xfun_0.4          
## [19] dplyr_0.8.1        stringr_1.4.0      knitr_1.21        
## [22] desc_1.2.0         fs_1.3.1           tidyselect_0.2.5  
## [25] rprojroot_1.3-2    grid_3.5.1         reshape_0.8.8     
## [28] glue_1.3.1         R6_2.4.0           rmarkdown_1.11    
## [31] purrr_0.2.5        ggplot2_3.1.0      magrittr_1.5      
## [34] matrixStats_0.54.0 backports_1.1.3    scales_1.0.0      
## [37] htmltools_0.3.6    MASS_7.3-51.4      RUnit_0.4.32      
## [40] assertthat_0.2.1   colorspace_1.4-0   labeling_0.3      
## [43] stringi_1.2.4      lazyeval_0.2.1     munsell_0.5.0     
## [46] crayon_1.3.4</code></pre>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Glass K, Huttenhower C, Quackenbush J, Yuan GC. Passing Messages Between Biological Networks to Refine Predicted Interactions, <em>PLoS One</em>, 2013 May 31;8(5):e64832</p>
<p>Glass K, Quackenbush J, Silverman EK, Celli B, Rennard S, Yuan GC and DeMeo DL. Sexually-dimorphic targeting of functionally-related genes in COPD, <em>BMC Systems Biology</em>, 2014 Nov 28; <strong>8</strong>:118</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#example">Example</a></li>
      <li><a href="#comparing-state-specific-panda-networks">Comparing state-specific PANDA networks</a></li>
      <li><a href="#other-helpful-functions">Other helpful functions</a></li>
      <li><a href="#session-information">Session information</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tian Wang, John Platig, Marieke Kuijjer, Magha Padi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
